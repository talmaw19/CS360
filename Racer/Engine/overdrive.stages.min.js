var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,g,e){c!=Array.prototype&&c!=Object.prototype&&(c[g]=e.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var g=0;return $jscomp.iteratorPrototype(function(){return g<c.length?{done:!1,value:c[g++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.iteratorFromArray=function(c,g){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var e=0,d={next:function(){if(e<c.length){var a=e++;return{value:g(a,c[a]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(c,g,e,d){if(g){e=$jscomp.global;c=c.split(".");for(d=0;d<c.length-1;d++){var a=c[d];a in e||(e[a]={});e=e[a]}c=c[c.length-1];d=e[c];g=g(d);g!=d&&null!=g&&$jscomp.defineProperty(e,c,{configurable:!0,writable:!0,value:g})}};$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6-impl","es3");
OverDrive.Stages.SplashScreen=function(c,g,e){var d=OverDrive.Game.system;c.Create=function(){return new c.SplashScreen};c.SplashScreen=function(){var a=this;this.transitionLinks={mainMenu:null};this.setTransition=function(b,f){a.transitionLinks[b]=f};this.leaveState={id:null,params:null};this.backgroundImage=null;this.timeElapsed=0;this.keyDown=null;this.preTransition=function(a){};this.init=function(){a.backgroundImage=new OverDrive.Game.Background("Assets/Images/splashscreen.png");null===a.keyDown&&
(a.keyDown=Array(256));for(var b=0;256>b;++b)a.keyDown[b]=!1;$(document).on("keyup",a.onKeyUp);$(document).on("keydown",a.onKeyDown);window.requestAnimationFrame(a.phaseInLoop)};this.phaseInLoop=function(){d.gameClock.tick();a.timeElapsed+=d.gameClock.convertTimeIntervalToSeconds(d.gameClock.deltaTime);e.globalAlpha=a.timeElapsed/1;a.backgroundImage&&a.backgroundImage.draw();1>a.timeElapsed?window.requestAnimationFrame(a.phaseInLoop):(d.gameClock.stop(),window.requestAnimationFrame(a.mainLoop))};
this.mainLoop=function(){a.keyPressed()?window.requestAnimationFrame(a.initPhaseOut):window.requestAnimationFrame(a.mainLoop)};this.initPhaseOut=function(){a.timeElapsed=0;d.gameClock.start();window.requestAnimationFrame(a.phaseOutLoop)};this.phaseOutLoop=function(){d.gameClock.tick();a.timeElapsed+=d.gameClock.convertTimeIntervalToSeconds(d.gameClock.deltaTime);e.globalAlpha=1-a.timeElapsed/2;a.backgroundImage&&a.backgroundImage.draw();2>a.timeElapsed?window.requestAnimationFrame(a.phaseOutLoop):
window.requestAnimationFrame(a.leaveStage)};this.leaveStage=function(){$(document).off("keydown");$(document).off("keyup");e.globalAlpha=1;a.leaveState.id="mainMenu";a.leaveState.params={};var b=a.transitionLinks[a.leaveState.id];b.preTransition(a.leaveState.params);window.requestAnimationFrame(b.init);a.leaveState.id=null;a.leaveState.params=null};this.onKeyDown=function(b){a.keyDown[b.keyCode]=!0};this.onKeyUp=function(b){a.keyDown[b.keyCode]=!1};this.keyPressed=function(){for(var a=!1,f=0;256>
f&&!a;++f)a=this.keyDown[f];return a}};return c}(OverDrive.Stages.SplashScreen||{},OverDrive.canvas,OverDrive.context);OverDrive.Stages.MainMenu=function(c,g,e){var d=OverDrive.Game.system;c.Create=function(){return new c.MainMenu};c.MainMenu=function(){var a=this;this.transitionLinks={mainGame:null,config:null,highScores:null,credits:null};this.setTransition=function(b,f){a.transitionLinks[b]=f};this.leaveState={id:null,params:null};this.keyDown=this.backgroundImage=null;this.selectedOption=-1;this.optionMetrics=this.menuOptions=null;this.optionExtent={maxWidth:0};this.preTransition=function(a){};this.init=function(){console.log("main menu init");
null===a.backgroundImage&&(a.backgroundImage=new OverDrive.Game.Background("Assets/Images/splashscreen.png"));null===a.keyDown&&(a.keyDown=Array(256));for(var b=0;256>b;++b)a.keyDown[b]=!1;$(document).on("keyup",a.onKeyUp);$(document).on("keydown",a.onKeyDown);a.selectedOption=-1;null===a.menuOptions&&(a.menuOptions=[{optionNumber:d.Keys.K_1,optionText:"1. Start Game",target:"mainGame"},{optionNumber:d.Keys.K_2,optionText:"2. Settings",target:"config"},{optionNumber:d.Keys.K_3,optionText:"3. High Scores",
target:"highScores"},{optionNumber:d.Keys.K_4,optionText:"4. Credits",target:"credits"}]);if(null===a.optionMetrics)for(e.font="30pt Amatic SC",a.optionMetrics=[],b=0;b<a.menuOptions.length;++b){var f=e.measureText(a.menuOptions[b].optionText);a.optionMetrics.push({width:f.width});a.optionExtent.maxWidth=Math.max(a.optionExtent.maxWidth,f.width)}window.requestAnimationFrame(a.phaseInLoop)};this.phaseInLoop=function(){window.requestAnimationFrame(a.mainLoop)};this.mainLoop=function(){d.gameClock.tick();
a.draw();for(var b=0;b<a.menuOptions.length;++b)a.keyDown[a.menuOptions[b].optionNumber]&&(console.log(a.menuOptions[b].optionText+" selected"),a.selectedOption=b);-1==a.selectedOption?window.requestAnimationFrame(a.mainLoop):window.requestAnimationFrame(a.initPhaseOut)};this.initPhaseOut=function(){window.requestAnimationFrame(a.phaseOutLoop)};this.phaseOutLoop=function(){window.requestAnimationFrame(a.leaveStage)};this.leaveStage=function(){$(document).off("keydown");$(document).off("keyup");a.leaveState.id=
a.menuOptions[a.selectedOption].target;a.leaveState.params={backgroundImage:a.backgroundImage};"mainGame"==a.leaveState.id&&(a.leaveState.params.level=1);var b=a.transitionLinks[a.leaveState.id];b.preTransition(a.leaveState.params);window.requestAnimationFrame(b.init);a.leaveState.id=null;a.leaveState.params=null};this.onKeyDown=function(b){a.keyDown[b.keyCode]=!0};this.onKeyUp=function(b){a.keyDown[b.keyCode]=!1};this.draw=function(){this.backgroundImage&&(e.globalAlpha=.4,this.backgroundImage.draw());
e.globalAlpha=1;e.fillStyle="#FFF";e.font="30pt Amatic SC";for(var a=(g.width-this.optionExtent.maxWidth)/2,f=250,d=0;d<this.menuOptions.length;++d)e.fillText(this.menuOptions[d].optionText,a,f),f+=50}};return c}(OverDrive.Stages.MainMenu||{},OverDrive.canvas,OverDrive.context);OverDrive.Stages.InputConfirm=function(c,g,e){var d=OverDrive.Game.system;c.Create=function(){return new c.InputConfirmStage};c.InputConfirmStage=function(){var a=this;this.transitionLinks={mainGame:null,mainMenu:null};this.setTransition=function(b,f){a.transitionLinks[b]=f};this.leaveState={id:null,params:null};this.backgroundImage=null;this.returnToMainMenu=this.player2Selected=this.player1Selected=!1;this.player2Message=this.player1Message=this.keyDown=null;this.preTransition=function(a){this.backgroundImage=
a.backgroundImage};this.init=function(){console.log("Input confirm pre-start screen");null===a.keyDown&&(a.keyDown=Array(256));for(var b=0;256>b;++b)a.keyDown[b]=!1;$(document).on("keyup",a.onKeyUp);$(document).on("keydown",a.onKeyDown);b=document.createElement("button");b.setAttribute("type","button");b.setAttribute("class","btn btn-default settingsField");b.setAttribute("id","returnToMenuButton");b.appendChild(document.createTextNode("Back to Main Menu"));document.getElementById("GameDiv").appendChild(b);
$("#returnToMenuButton").click(a.goBackToMenu);a.returnToMainMenu=!1;a.player1Selected=!1;a.player2Selected=!1;d.Gamepad.clearBindings();window.requestAnimationFrame(a.player1PreConfirm)};this.player1PreConfirm=function(){player1Message=[];d.settings.players[0].mode==OverDrive.Game.InputMode.Keyboard?player1Message.push(d.settings.players[0].name+" - Press the Accelerate key to start"):d.settings.players[0].mode==OverDrive.Game.InputMode.Gamepad&&(0<d.Gamepad.getUnboundGamepadArray().length?player1Message.push(d.settings.players[0].name+
" - Press any button on your gamepad to start!"):(player1Message.push(d.settings.players[0].name+" - Plug in a controller..."),player1Message.push("...and press any button to start!")));a.player1Selected=!1;window.requestAnimationFrame(a.player1Confirm)};this.player1Confirm=function(){a.draw(player1Message);if(d.settings.players[0].mode==OverDrive.Game.InputMode.Keyboard)a.keyPressed(d.settings.players[0].keys.forward)&&(a.player1Selected=!0);else if(d.settings.players[0].mode==OverDrive.Game.InputMode.Gamepad){var b=
d.Gamepad.getUnboundGamepadArray();if(0<b.length){for(var f=!1,k=0;k<b.length&&!f;)(f=d.Gamepad.gamepadButtonPressed(b[k]))||++k;f&&(d.Gamepad.bindings[0].gamepadIndex=b[k].index,console.log("1 : "+b[k].index),a.player1Selected=!0)}}a.player1Selected?window.requestAnimationFrame(a.player1PostConfirm):a.returnToMainMenu?(a.leaveState.id="mainMenu",window.requestAnimationFrame(a.leaveStage)):window.requestAnimationFrame(a.player1Confirm)};this.player1PostConfirm=function(){console.log("player 1 selected");
window.requestAnimationFrame(a.player2PreConfirm)};this.player2PreConfirm=function(){player2Message=[];d.settings.players[1].mode==OverDrive.Game.InputMode.Keyboard?player2Message.push(d.settings.players[1].name+" - Press the Accelerate key to start"):d.settings.players[1].mode==OverDrive.Game.InputMode.Gamepad&&(0<d.Gamepad.getUnboundGamepadArray().length?player2Message.push(d.settings.players[1].name+" - Press any button on your gamepad to start!"):(player2Message.push(d.settings.players[1].name+
" - Plug in a controller..."),player2Message.push("...and press any button to start!")));a.player2Selected=!1;window.requestAnimationFrame(a.player2Confirm)};this.player2Confirm=function(){a.draw(player2Message);if(d.settings.players[1].mode==OverDrive.Game.InputMode.Keyboard)a.keyPressed(d.settings.players[1].keys.forward)&&(a.player2Selected=!0);else if(d.settings.players[1].mode==OverDrive.Game.InputMode.Gamepad){var b=d.Gamepad.getUnboundGamepadArray();if(0<b.length){for(var f=!1,k=0;k<b.length&&
!f;)(f=d.Gamepad.gamepadButtonPressed(b[k]))||++k;f&&(d.Gamepad.bindings[1].gamepadIndex=b[k].index,console.log("2 : "+b[k].index),a.player2Selected=!0)}}a.player2Selected?window.requestAnimationFrame(a.player2PostConfirm):a.returnToMainMenu?(a.leaveState.id="mainMenu",window.requestAnimationFrame(a.leaveStage)):window.requestAnimationFrame(a.player2Confirm)};this.player2PostConfirm=function(){console.log("player 2 selected");a.leaveState.id="mainGame";a.leaveState.params={level:1};window.requestAnimationFrame(a.leaveStage)};
this.leaveStage=function(){$(document).off("keydown");$(document).off("keyup");a.backgroundImage=null;document.getElementById("GameDiv").removeChild(document.getElementById("returnToMenuButton"));var b=a.transitionLinks[a.leaveState.id];b.preTransition(a.leaveState.params);window.requestAnimationFrame(b.init);a.leaveState.id=null;a.leaveState.params=null};this.onKeyDown=function(b){a.keyDown[b.keyCode]=!0};this.onKeyUp=function(b){a.keyDown[b.keyCode]=!1};this.goBackToMenu=function(b){a.returnToMainMenu=
!0};this.keyPressed=function(a){return this.keyDown[d.Keys[a]]};this.draw=function(b){a.backgroundImage&&(e.globalAlpha=.4,a.backgroundImage.draw());e.globalAlpha=1;e.fillStyle="#FFF";e.font="38pt Amatic SC";for(var f=b.length,d=300-f/2*30,c=0;c<f;++c,d+=44){var m=e.measureText(b[c]);e.fillText(b[c],.5*g.width-m.width/2,d)}}};return c}(OverDrive.Stages.InputConfirm||{},OverDrive.canvas,OverDrive.context);OverDrive.Game=function(c,g,e){c.InputMode={Keyboard:0,Gamepad:1};c.CameraMode={Test:0,Normal:1,Fixed:2};c.cameraWindowScale=5;c.OrthoCamera=function(d){var a=this;this.pos={x:g.width/2,y:g.height/2};this.width=g.width;this.height=g.height;this.mode=d;this.calculateCameraWindow=function(b,f){var d=function(a){return(1/Math.exp(.0025*a)*2.5+1)*a},c=function(b,f){a.pos.x=(b.mBody.position.x+f.mBody.position.x)/2;a.pos.y=(b.mBody.position.y+f.mBody.position.y)/2},e=function(b,f){var c=Math.abs(b.mBody.position.x-
f.mBody.position.x),k=Math.abs(b.mBody.position.y-f.mBody.position.y);a.width=Math.min(g.width,Math.max(300,d(Math.sqrt(c*c+k*k))));a.height=g.height/g.width*a.width};b.mBody&&f.mBody&&(c(b,f),e(b,f),0>a.pos.x-a.width/2?a.pos.x=a.width/2:a.pos.x+a.width/2>=g.width&&(a.pos.x=g.width-a.width/2),0>a.pos.y-a.height/2?a.pos.y=a.height/2:a.pos.y+a.height/2>=g.height&&(a.pos.y=g.height-a.height/2))};this.drawTestWindow=function(){a.mode==c.CameraMode.Test&&(e.beginPath(),e.moveTo(a.pos.x-a.width/2,a.pos.y-
a.height/2),e.lineTo(a.pos.x+a.width/2,a.pos.y-a.height/2),e.lineTo(a.pos.x+a.width/2,a.pos.y+a.height/2),e.lineTo(a.pos.x-a.width/2,a.pos.y+a.height/2),e.closePath(),e.lineWidth=1,e.strokeStyle="#FFF",e.stroke())}};return c}(OverDrive.Game||{},OverDrive.canvas,OverDrive.context);
OverDrive.Stages.MainGame=function(c,g,e){var d=OverDrive.Game.system;c.Create=function(){return new c.MainGame};c.MainGame=function(){var a=this;this.transitionLinks={mainMenu:null};this.setTransition=function(b,f){a.transitionLinks[b]=f};this.leaveState={id:null,params:null};this.level=1;this.trackIndex=0;this.keyDown=this.orthoCamera=this.backgroundImage=null;this.levelComplete=this.paused=this.raceStarted=!1;this.sceneryRegions=this.regions=this.winner=null;this.lapTime=this.baseTime=0;this.pickupArray=
this.pickupTypes=null;this.preTransition=function(b){a.level=b.level;a.trackIndex=a.level-1;console.log("entering level "+a.level)};this.init=function(){null===a.keyDown&&(a.keyDown=Array(256));for(var b=0;256>b;++b)a.keyDown[b]=!1;$(document).on("keyup",a.onKeyUp);$(document).on("keydown",a.onKeyDown);a.setup();a.path=new OverDrive.Game.Path(a.regions,d.engine.world,1);a.player1.pathLocation=a.path.initPathPlacement();a.player2.pathLocation=a.path.initPathPlacement();OverDrive.Game.system.engine.world.gravity.y=
0;var b=Matter.Bodies.rectangle(-50,g.height/2,100,g.height,{isStatic:!0}),f=Matter.Bodies.rectangle(g.width+50,g.height/2,100,g.height,{isStatic:!0}),c=Matter.Bodies.rectangle(g.width/2,-50,g.width,100,{isStatic:!0}),e=Matter.Bodies.rectangle(g.width/2,g.height+50,g.width,100,{isStatic:!0});b.collisionFilter.group=0;b.collisionFilter.category=OverDrive.Game.CollisionModel.StaticScene.Category;b.collisionFilter.mask=OverDrive.Game.CollisionModel.StaticScene.Mask;f.collisionFilter.group=0;f.collisionFilter.category=
OverDrive.Game.CollisionModel.StaticScene.Category;f.collisionFilter.mask=OverDrive.Game.CollisionModel.StaticScene.Mask;c.collisionFilter.group=0;c.collisionFilter.category=OverDrive.Game.CollisionModel.StaticScene.Category;c.collisionFilter.mask=OverDrive.Game.CollisionModel.StaticScene.Mask;e.collisionFilter.group=0;e.collisionFilter.category=OverDrive.Game.CollisionModel.StaticScene.Category;e.collisionFilter.mask=OverDrive.Game.CollisionModel.StaticScene.Mask;Matter.World.add(OverDrive.Game.system.engine.world,
[b,f,c,e]);Matter.Events.on(OverDrive.Game.system.engine,"collisionStart",function(b){b=b.pairs;for(var f=0;f<b.length;++f)void 0!==b[f].bodyA.hostObject&&void 0!==b[f].bodyB.hostObject&&b[f].bodyA.hostObject.doCollision(b[f].bodyB.hostObject,{objA:b[f].bodyA,objB:b[f].bodyB,host:a})});Matter.Events.on(OverDrive.Game.system.engine,"beforeUpdate",function(b){b=b.source.world;for(var f=0;f<b.bodies.length;++f)void 0!==b.bodies[f].hostObject&&void 0!==b.bodies[f].hostObject.preUpdate&&b.bodies[f].hostObject.preUpdate(b.bodies[f].hostObject,
OverDrive.Game.system.gameClock.deltaTime,a)});Matter.Events.on(OverDrive.Game.system.engine,"afterUpdate",function(b){b=b.source.world;for(var f=0;f<b.bodies.length;++f)void 0!==b.bodies[f].hostObject&&void 0!==b.bodies[f].hostObject.postUpdate&&b.bodies[f].hostObject.postUpdate(b.bodies[f].hostObject,OverDrive.Game.system.gameClock.deltaTime,a)});a.pickupTypes=[];a.pickupArray=[];a.pickup_timer=pickup_time_delay;a.pickupTypes.points_pickup=new OverDrive.Pickup.PickupType({spriteURI:"Assets//Images//coin1.png",
collisionGroup:0,handler:function(a){a.addPoints(50)}});a.pickupTypes.points_pickup2=new OverDrive.Pickup.PickupType({spriteURI:"Assets//Images//coin2.png",collisionGroup:0,handler:function(a){a.addPoints(50)}});a.countDownSecondsElapsed=0;d.gameClock.tick();a.raceStarted=!1;window.requestAnimationFrame(a.phaseInLoop)};this.phaseInLoop=function(){d.gameClock.tick();var b=d.gameClock.convertTimeIntervalToSeconds(d.gameClock.deltaTime);a.countDownSecondsElapsed+=b;a.renderMainScene();e.fillStyle="#FFF";
e.font="50pt Amatic SC";var b=3-Math.floor(a.countDownSecondsElapsed),f=e.measureText(b);e.fillText(b,.5*g.width-f.width/2,300);OverDrive.Game.drawHUD(a.player1,a.player2,!1,a.lapTime,a.path.maxIterations);3>a.countDownSecondsElapsed?window.requestAnimationFrame(a.phaseInLoop):(a.paused=!1,a.levelComplete=!1,a.baseTime=d.gameClock.gameTimeElapsed(),a.lapTime=0,a.raceStarted=!0,window.requestAnimationFrame(a.mainLoopActual))};this.mainLoopActual=function(){var b=OverDrive.Pickup.processPickups(a.pickupTypes,
d.engine,a.pickup_timer,d.gameClock.convertTimeIntervalToSeconds(d.gameClock.deltaTime),a.regions);a.pickup_timer=b.timer;b.newPickup&&(Matter.World.add(d.engine.world,[b.newPickup.mBody]),a.pickupArray.push(b.newPickup));a.mainLoop()};this.initPhaseOut=function(){a.winner.score+=200;a.winnerMessage=a.winner.pid+" Wins!!!!!";window.requestAnimationFrame(a.phaseOutLoop)};this.phaseOutLoop=function(){OverDrive.Game.system.gameClock.tick();a.lapTime=d.gameClock.gameTimeElapsed()-a.baseTime;Matter.Engine.update(d.engine,
d.gameClock.deltaTime);a.renderMainScene();e.fillStyle="#FFF";e.font="50pt Amatic SC";var b=e.measureText(a.winnerMessage);e.fillText(a.winnerMessage,.5*g.width-b.width/2,300);a.keyPressed("ESC")?window.requestAnimationFrame(a.leaveStage):window.requestAnimationFrame(a.phaseOutLoop)};this.leaveStage=function(){d.scores.push({name:a.winner.pid,score:a.winner.score});d.sortScores();$(document).on("keyup",a.onKeyUp);$(document).on("keydown",a.onKeyDown);Matter.Events.off(OverDrive.Game.system.engine);
Matter.World.clear(d.engine.world,!1);a.backgroundImage=null;a.orthoCamera=null;a.gamepads={};a.paused=!1;a.levelComplete=!1;a.winner=null;a.regions=null;a.sceneryRegions=null;a.baseTime=0;a.lapTime=0;a.pickupTypes=null;a.pickupArray=null;a.leaveState.id="mainMenu";a.leaveState.params={};var b=a.transitionLinks[a.leaveState.id];b.preTransition(a.leaveState.params);window.requestAnimationFrame(b.init);a.leaveState.id=null;a.leaveState.params=null};this.onKeyDown=function(b){a.keyDown[b.keyCode]=!0};
this.onKeyUp=function(b){a.keyDown[b.keyCode]=!1};this.renderMainScene=function(){a.orthoCamera.calculateCameraWindow(a.player1,a.player2);a.orthoCamera.mode==OverDrive.Game.CameraMode.Normal&&(e.save(),e.scale(g.width/a.orthoCamera.width,g.height/a.orthoCamera.height),e.translate(-(a.orthoCamera.pos.x-a.orthoCamera.width/2),-(a.orthoCamera.pos.y-a.orthoCamera.height/2)));a.drawLevel();a.orthoCamera.mode==OverDrive.Game.CameraMode.Normal?e.restore():a.orthoCamera.mode==OverDrive.Game.CameraMode.Test&&
a.orthoCamera.drawTestWindow()};this.drawLevel=function(){a.backgroundImage&&a.backgroundImage.draw();a.player1&&a.player1.draw();a.player2&&a.player2.draw();OverDrive.Game.drawObjects(a.pickupArray)};this.keyPressed=function(a){return this.keyDown[d.Keys[a]]};this.updatePlayer1=function(a,f,c){a.mBody.speed>player_top_speed&&(f=Matter.Vector.normalise(a.mBody.velocity),f.x*=player_top_speed,f.y*=player_top_speed,Matter.Body.setVelocity(a.mBody,f));f=d.settings.players[0].mode;f==OverDrive.Game.InputMode.Gamepad?
this.handleGamepadInput(a,0):f==OverDrive.Game.InputMode.Keyboard&&(this.keyPressed(d.settings.players[0].keys.forward)&&(f=a.forwardDirection(),a.applyForce(a.mBody.position,{x:f.x*a.forwardForce,y:f.y*a.forwardForce})),this.keyPressed(d.settings.players[0].keys.reverse)&&(f=a.forwardDirection(),a.applyForce(a.mBody.position,{x:-f.x*a.forwardForce,y:-f.y*a.forwardForce})),this.keyPressed(d.settings.players[0].keys.left)&&(Matter.Body.setAngularVelocity(a.mBody,0),a.rotate(-Math.PI*a.rotateSpeed)),
this.keyPressed(d.settings.players[0].keys.right)&&(Matter.Body.setAngularVelocity(a.mBody,0),a.rotate(Math.PI*a.rotateSpeed)))};this.updatePlayer2=function(a,f,c){a.mBody.speed>player_top_speed&&(f=Matter.Vector.normalise(a.mBody.velocity),f.x*=player_top_speed,f.y*=player_top_speed,Matter.Body.setVelocity(a.mBody,f));f=d.settings.players[1].mode;f==OverDrive.Game.InputMode.Gamepad?this.handleGamepadInput(a,1):f==OverDrive.Game.InputMode.Keyboard&&(this.keyPressed(d.settings.players[1].keys.forward)&&
(f=a.forwardDirection(),a.applyForce(a.mBody.position,{x:f.x*a.forwardForce,y:f.y*a.forwardForce})),this.keyPressed(d.settings.players[1].keys.reverse)&&(f=a.forwardDirection(),a.applyForce(a.mBody.position,{x:-f.x*a.forwardForce,y:-f.y*a.forwardForce})),this.keyPressed(d.settings.players[1].keys.left)&&(Matter.Body.setAngularVelocity(a.mBody,0),a.rotate(-Math.PI*a.rotateSpeed)),this.keyPressed(d.settings.players[1].keys.right)&&(Matter.Body.setAngularVelocity(a.mBody,0),a.rotate(Math.PI*a.rotateSpeed)))};
this.handleGamepadInput=function(a,f){var b=d.Gamepad.gamepads[d.Gamepad.bindings[f].gamepadIndex];if(b&&b.connected){if(b.buttons[0].pressed){var c=a.forwardDirection();a.applyForce(a.mBody.position,{x:c.x*a.forwardForce,y:c.y*a.forwardForce})}b.buttons[1].pressed&&(c=a.forwardDirection(),a.applyForce(a.mBody.position,{x:-c.x*a.forwardForce*.25,y:-c.y*a.forwardForce*.25}));Matter.Body.setAngularVelocity(a.mBody,0);.1<Math.abs(b.axes[0])&&a.rotate(Math.PI*a.rotateSpeed*b.axes[0])}}};return c}(OverDrive.Stages.MainGame||
{},OverDrive.canvas,OverDrive.context);OverDrive.Stages.MainGame=function(c,g,e){var d=OverDrive.Game.system,a=OverDrive.Game.tracks,b=OverDrive.Game.scenery;c.MainGame.prototype.createTrack=function(){var b=a[this.trackIndex];this.regions=[];for(var d=0;d<b.regions.length;++d){var c=OverDrive.Region.Create();c.points=b.regions[d].points;OverDrive.Region.BuildCollisionModel(c);this.regions.push(c)}OverDrive.Graph.BuildGraph(this.regions)};c.MainGame.prototype.createScenery=function(){this.sceneryRegions=[];for(var a=0;a<b[this.trackIndex].regions.length;++a){var c=
OverDrive.Region.Create();c.points=b[this.trackIndex].regions[a].points;OverDrive.Region.BuildCollisionModel(c);this.sceneryRegions.push(c)}for(a=0;a<this.sceneryRegions.length;++a){for(var c=[],e=0,m=0,h=0;h<this.sceneryRegions[a].collisionModel.vertices.length;++h)e+=this.sceneryRegions[a].collisionModel.vertices[h].x*g.width,m+=this.sceneryRegions[a].collisionModel.vertices[h].y*g.height;e/=this.sceneryRegions[a].collisionModel.vertices.length;m/=this.sceneryRegions[a].collisionModel.vertices.length;
for(h=0;h<this.sceneryRegions[a].collisionModel.vertices.length;++h)c.push({x:this.sceneryRegions[a].collisionModel.vertices[h].x*g.width,y:this.sceneryRegions[a].collisionModel.vertices[h].y*g.height});c=Matter.Bodies.fromVertices(e,m,c,{isStatic:!0});c.collisionFilter.group=0;c.collisionFilter.category=OverDrive.Game.CollisionModel.StaticScene.Category;c.collisionFilter.mask=OverDrive.Game.CollisionModel.StaticScene.Mask;Matter.World.add(d.engine.world,c)}};c.MainGame.prototype.setupBackground=
function(){this.backgroundImage=new OverDrive.Game.Background(a[this.trackIndex].trackImage.imageURL)};c.MainGame.prototype.initialiseCamera=function(){this.orthoCamera=new OverDrive.Game.OrthoCamera(OverDrive.Game.CameraMode.Normal)};c.MainGame.prototype.createPlayer1=function(){var b=this,c=a[b.trackIndex];b.player1=new OverDrive.Game.Player({pid:d.settings.players[0].name,x:c.players[0].pos.x*g.width,y:c.players[0].pos.y*g.height,angle:c.players[0].angle,scale:c.players[0].scale,rotateSpeed:.01,
forwardForce:.005,spriteURI:c.players[0].playerImageURI,world:d.engine.world,mass:player_mass,boundingVolumeScale:.75,collisionGroup:-1,preUpdate:function(a,f,d){b.updatePlayer1(a,f,d)},postUpdate:function(a,b,f){}})};c.MainGame.prototype.createPlayer2=function(){var b=this,c=a[b.trackIndex];b.player2=new OverDrive.Game.Player({pid:d.settings.players[1].name,x:c.players[1].pos.x*g.width,y:c.players[1].pos.y*g.height,angle:c.players[1].angle,scale:c.players[1].scale,rotateSpeed:.01,forwardForce:.005,
spriteURI:c.players[1].playerImageURI,world:d.engine.world,mass:player_mass,boundingVolumeScale:.75,collisionGroup:-2,preUpdate:function(a,f,c){b.updatePlayer2(a,f,c)},postUpdate:function(a,b,f){}})};c.MainGame.prototype.startClock=function(){d.gameClock.start()};c.MainGame.prototype.startGameLoop=function(){};c.MainGame.prototype.updateClock=function(){OverDrive.Game.system.gameClock.tick();this.lapTime=d.gameClock.gameTimeElapsed()-this.baseTime};c.MainGame.prototype.animatePlayers=function(){Matter.Engine.update(d.engine,
d.gameClock.deltaTime)};c.MainGame.prototype.drawNewAnimationFrame=function(){this.renderMainScene();OverDrive.Game.drawHUD(this.player1,this.player2,!0,this.lapTime,this.path.maxIterations)};c.MainGame.prototype.player1CrossedFinishLine=function(){return this.player1.pathLocation.pathComplete?(this.winner=this.player1,this.levelComplete=!0):!1};c.MainGame.prototype.player2CrossedFinishLine=function(){return this.player2.pathLocation.pathComplete?(this.winner=this.player2,this.levelComplete=!0):!1};
c.MainGame.prototype.repeatGameLoop=function(){window.requestAnimationFrame(this.mainLoopActual)};c.MainGame.prototype.leaveGameLoop=function(){window.requestAnimationFrame(this.initPhaseOut)};return c}(OverDrive.Stages.MainGame||{},OverDrive.canvas,OverDrive.context);OverDrive.Stages.MainGame=function(c,g,e){c.MainGame.prototype.setup=function(){this.createTrack();this.createScenery();this.setupBackground();this.initialiseCamera();this.createPlayer1();this.createPlayer2();this.startClock();this.startGameLoop()};c.MainGame.prototype.mainLoop=function(){this.updateClock();this.animatePlayers();this.drawNewAnimationFrame();this.player1CrossedFinishLine()||this.player2CrossedFinishLine()?this.leaveGameLoop():this.repeatGameLoop()};return c}(OverDrive.Stages.MainGame||
{},OverDrive.canvas,OverDrive.context);OverDrive.Stages.Config=function(c,g,e){var d=OverDrive.Game.system;c.Create=function(){return new c.ConfigStage};c.ConfigStage=function(){var a=this;this.transitionLinks={mainMenu:null};this.setTransition=function(b,f){a.transitionLinks[b]=f};this.leaveState={id:null,params:null};this.backgroundImage=null;this.exitConfig=!1;this.keyDown=null;this.preTransition=function(a){this.backgroundImage=a.backgroundImage};this.init=function(){console.log("settings (config) screen");null===a.keyDown&&(a.keyDown=
Array(256));for(var b=0;256>b;++b)a.keyDown[b]=!1;$(document).on("keyup",a.onKeyUp);$(document).on("keydown",a.onKeyDown);a.backgroundImage&&(e.globalAlpha=.4,a.backgroundImage.draw());e.globalAlpha=1;a.createPlayer1Elements();a.createPlayer2Elements();b=document.createElement("button");b.setAttribute("type","button");b.setAttribute("class","btn btn-default settingsField");b.setAttribute("id","configAcceptButton");b.appendChild(document.createTextNode("Accept"));document.getElementById("GameDiv").appendChild(b);
$("#configAcceptButton").click(a.accept);b=document.createElement("button");b.setAttribute("type","button");b.setAttribute("class","btn btn-default settingsField");b.setAttribute("id","configCancelButton");b.appendChild(document.createTextNode("Cancel"));document.getElementById("GameDiv").appendChild(b);$("#configCancelButton").click(a.cancel);a.exitConfig=!1;window.requestAnimationFrame(a.mainLoop)};this.phaseInLoop=function(){};this.mainLoop=function(){a.keyPressed("ESC")&&(a.exitConfig=!0);a.exitConfig?
(a.leaveState.id="mainMenu",a.leaveState.params={},window.requestAnimationFrame(a.leaveStage)):window.requestAnimationFrame(a.mainLoop)};this.initPhaseOut=function(){};this.phaseOutLoop=function(){};this.leaveStage=function(){$(document).off("keydown");$(document).off("keyup");a.backgroundImage=null;document.getElementById("GameDiv").removeChild(document.getElementById("player1Div"));document.getElementById("GameDiv").removeChild(document.getElementById("player2Div"));document.getElementById("GameDiv").removeChild(document.getElementById("configAcceptButton"));
document.getElementById("GameDiv").removeChild(document.getElementById("configCancelButton"));var b=a.transitionLinks[a.leaveState.id];b.preTransition(a.leaveState.params);window.requestAnimationFrame(b.init);a.leaveState.id=null;a.leaveState.params=null};this.onKeyDown=function(b){a.keyDown[b.keyCode]=!0};this.onKeyUp=function(b){a.keyDown[b.keyCode]=!1};this.accept=function(b){d.settings.players[0].name=$("#player1NameField").val();d.settings.players[0].keys.forward=$("#p1AccelKeyField").val().toUpperCase();
d.settings.players[0].keys.reverse=$("#p1BrakeKeyField").val().toUpperCase();d.settings.players[0].keys.left=$("#p1LeftKeyField").val().toUpperCase();d.settings.players[0].keys.right=$("#p1RightKeyField").val().toUpperCase();document.getElementById("p1ControllerButton").checked?d.settings.players[0].mode=OverDrive.Game.InputMode.Gamepad:document.getElementById("p1KeyboardButton").checked&&(d.settings.players[0].mode=OverDrive.Game.InputMode.Keyboard);d.settings.players[1].name=$("#player2NameField").val();
d.settings.players[1].keys.forward=$("#p2AccelKeyField").val().toUpperCase();d.settings.players[1].keys.reverse=$("#p2BrakeKeyField").val().toUpperCase();d.settings.players[1].keys.left=$("#p2LeftKeyField").val().toUpperCase();d.settings.players[1].keys.right=$("#p2RightKeyField").val().toUpperCase();document.getElementById("p2ControllerButton").checked?d.settings.players[1].mode=OverDrive.Game.InputMode.Gamepad:document.getElementById("p2KeyboardButton").checked&&(d.settings.players[1].mode=OverDrive.Game.InputMode.Keyboard);
a.exitConfig=!0};this.cancel=function(b){a.exitConfig=!0};this.keyPressed=function(a){return this.keyDown[d.Keys[a]]};this.draw=function(){};this.createPlayer1Elements=function(){var a=document.createElement("div");a.setAttribute("id","player1Div");var f=document.createElement("h4");f.setAttribute("class","playerSettingsHeader");var c=document.createTextNode("Player 1 Settings");f.appendChild(c);a.appendChild(f);f=document.createElement("div");f.setAttribute("class","col-xs-6 settingsField settingsLabel playerNameLabel");
c=document.createElement("label");c.appendChild(document.createTextNode("Name"));f.appendChild(c);c=document.createElement("div");c.setAttribute("class","col-xs-6 settingsField playerNameField");var e=document.createElement("input");e.setAttribute("type","text");e.setAttribute("class","form-control");e.setAttribute("id","player1NameField");e.setAttribute("value",d.settings.players[0].name);c.appendChild(e);a.appendChild(f);a.appendChild(c);f=document.createElement("div");f.setAttribute("class","settingsField rinput");
p1ControllerLabel=document.createElement("label");p1ControllerLabel.setAttribute("class","radio-inline inputButtonBase");c=document.createElement("input");c.setAttribute("type","radio");c.setAttribute("name","p1InputMode");c.setAttribute("id","p1ControllerButton");e=document.createElement("img");e.setAttribute("src","Assets//Images//controller_icon.png");p1ControllerLabel.appendChild(c);p1ControllerLabel.appendChild(e);p1KeyboardLabel=document.createElement("label");p1KeyboardLabel.setAttribute("class",
"radio-inline");e=document.createElement("input");e.setAttribute("type","radio");e.setAttribute("name","p1InputMode");e.setAttribute("id","p1KeyboardButton");var g=document.createElement("img");g.setAttribute("src","Assets//Images//keyboard_icon.png");p1KeyboardLabel.appendChild(e);p1KeyboardLabel.appendChild(g);f.appendChild(p1ControllerLabel);f.appendChild(p1KeyboardLabel);d.settings.players[0].mode==OverDrive.Game.InputMode.Keyboard?e.setAttribute("checked","true"):d.settings.players[0].mode==
OverDrive.Game.InputMode.Gamepad&&c.setAttribute("checked","true");a.appendChild(f);f=document.createElement("div");f.setAttribute("class","col-xs-6 settingsField settingsLabel accelKeyLabel");c=document.createElement("label");c.appendChild(document.createTextNode("Forward / Accelerate"));f.appendChild(c);c=document.createElement("div");c.setAttribute("class","col-xs-3 settingsField accelKeyField");e=document.createElement("input");e.setAttribute("type","text");e.setAttribute("class","form-control");
e.setAttribute("id","p1AccelKeyField");e.setAttribute("value",d.settings.players[0].keys.forward);c.appendChild(e);e=document.createElement("div");e.setAttribute("class","col-xs-6 settingsField settingsLabel brakeKeyLabel");g=document.createElement("label");g.appendChild(document.createTextNode("Reverse / Brake"));e.appendChild(g);g=document.createElement("div");g.setAttribute("class","col-xs-3 settingsField brakeKeyField");var h=document.createElement("input");h.setAttribute("type","text");h.setAttribute("class",
"form-control");h.setAttribute("id","p1BrakeKeyField");h.setAttribute("value",d.settings.players[0].keys.reverse);g.appendChild(h);h=document.createElement("div");h.setAttribute("class","col-xs-6 settingsField settingsLabel leftKeyLabel");var n=document.createElement("label");n.appendChild(document.createTextNode("Steer Left"));h.appendChild(n);n=document.createElement("div");n.setAttribute("class","col-xs-3 settingsField leftKeyField");var l=document.createElement("input");l.setAttribute("type",
"text");l.setAttribute("class","form-control");l.setAttribute("id","p1LeftKeyField");l.setAttribute("value",d.settings.players[0].keys.left);n.appendChild(l);l=document.createElement("div");l.setAttribute("class","col-xs-6 settingsField settingsLabel rightKeyLabel");var p=document.createElement("label");p.appendChild(document.createTextNode("Steer Right"));l.appendChild(p);p=document.createElement("div");p.setAttribute("class","col-xs-3 settingsField rightKeyField");var q=document.createElement("input");
q.setAttribute("type","text");q.setAttribute("class","form-control");q.setAttribute("id","p1RightKeyField");q.setAttribute("value",d.settings.players[0].keys.right);p.appendChild(q);a.appendChild(f);a.appendChild(c);a.appendChild(e);a.appendChild(g);a.appendChild(h);a.appendChild(n);a.appendChild(l);a.appendChild(p);document.getElementById("GameDiv").appendChild(a)};this.createPlayer2Elements=function(){var a=document.createElement("div");a.setAttribute("id","player2Div");var c=document.createElement("h4");
c.setAttribute("class","playerSettingsHeader");var e=document.createTextNode("Player 2 Settings");c.appendChild(e);a.appendChild(c);c=document.createElement("div");c.setAttribute("class","col-xs-6 settingsField settingsLabel playerNameLabel");e=document.createElement("label");e.appendChild(document.createTextNode("Name"));c.appendChild(e);e=document.createElement("div");e.setAttribute("class","col-xs-6 settingsField playerNameField");var g=document.createElement("input");g.setAttribute("type","text");
g.setAttribute("class","form-control");g.setAttribute("id","player2NameField");g.setAttribute("value",d.settings.players[1].name);e.appendChild(g);a.appendChild(c);a.appendChild(e);c=document.createElement("div");c.setAttribute("class","settingsField rinput");p2ControllerLabel=document.createElement("label");p2ControllerLabel.setAttribute("class","radio-inline inputButtonBase");e=document.createElement("input");e.setAttribute("type","radio");e.setAttribute("name","p2InputMode");e.setAttribute("id",
"p2ControllerButton");g=document.createElement("img");g.setAttribute("src","Assets//Images//controller_icon.png");p2ControllerLabel.appendChild(e);p2ControllerLabel.appendChild(g);p2KeyboardLabel=document.createElement("label");p2KeyboardLabel.setAttribute("class","radio-inline");g=document.createElement("input");g.setAttribute("type","radio");g.setAttribute("name","p2InputMode");g.setAttribute("id","p2KeyboardButton");var m=document.createElement("img");m.setAttribute("src","Assets//Images//keyboard_icon.png");
p2KeyboardLabel.appendChild(g);p2KeyboardLabel.appendChild(m);c.appendChild(p2ControllerLabel);c.appendChild(p2KeyboardLabel);d.settings.players[1].mode==OverDrive.Game.InputMode.Keyboard?g.setAttribute("checked","true"):d.settings.players[1].mode==OverDrive.Game.InputMode.Gamepad&&e.setAttribute("checked","true");a.appendChild(c);c=document.createElement("div");c.setAttribute("class","col-xs-6 settingsField settingsLabel accelKeyLabel");e=document.createElement("label");e.appendChild(document.createTextNode("Forward / Accelerate"));
c.appendChild(e);e=document.createElement("div");e.setAttribute("class","col-xs-3 settingsField accelKeyField");g=document.createElement("input");g.setAttribute("type","text");g.setAttribute("class","form-control");g.setAttribute("id","p2AccelKeyField");g.setAttribute("value",d.settings.players[1].keys.forward);e.appendChild(g);g=document.createElement("div");g.setAttribute("class","col-xs-6 settingsField settingsLabel brakeKeyLabel");m=document.createElement("label");m.appendChild(document.createTextNode("Reverse / Brake"));
g.appendChild(m);m=document.createElement("div");m.setAttribute("class","col-xs-3 settingsField brakeKeyField");var h=document.createElement("input");h.setAttribute("type","text");h.setAttribute("class","form-control");h.setAttribute("id","p2BrakeKeyField");h.setAttribute("value",d.settings.players[1].keys.reverse);m.appendChild(h);h=document.createElement("div");h.setAttribute("class","col-xs-6 settingsField settingsLabel leftKeyLabel");var n=document.createElement("label");n.appendChild(document.createTextNode("Steer Left"));
h.appendChild(n);n=document.createElement("div");n.setAttribute("class","col-xs-3 settingsField leftKeyField");var l=document.createElement("input");l.setAttribute("type","text");l.setAttribute("class","form-control");l.setAttribute("id","p2LeftKeyField");l.setAttribute("value",d.settings.players[1].keys.left);n.appendChild(l);l=document.createElement("div");l.setAttribute("class","col-xs-6 settingsField settingsLabel rightKeyLabel");var p=document.createElement("label");p.appendChild(document.createTextNode("Steer Right"));
l.appendChild(p);p=document.createElement("div");p.setAttribute("class","col-xs-3 settingsField rightKeyField");var q=document.createElement("input");q.setAttribute("type","text");q.setAttribute("class","form-control");q.setAttribute("id","p2RightKeyField");q.setAttribute("value",d.settings.players[1].keys.right);p.appendChild(q);a.appendChild(c);a.appendChild(e);a.appendChild(g);a.appendChild(m);a.appendChild(h);a.appendChild(n);a.appendChild(l);a.appendChild(p);document.getElementById("GameDiv").appendChild(a)}};
return c}(OverDrive.Stages.Config||{},OverDrive.canvas,OverDrive.context);OverDrive.Stages.Leaderboard=function(c,g,e){var d=OverDrive.Game.system;c.Create=function(){return new c.LeaderboardStage};c.LeaderboardStage=function(){var a=this;this.transitionLinks={mainMenu:null};this.setTransition=function(b,c){a.transitionLinks[b]=c};this.leaveState={id:null,params:null};this.backgroundImage=null;this.baseY=600;this.exitLeaderboard=!1;this.keyDown=null;this.preTransition=function(a){this.backgroundImage=a.backgroundImage};this.init=function(){a.baseY=600;a.exitLeaderboard=
!1;null===a.keyDown&&(a.keyDown=Array(256));for(var b=0;256>b;++b)a.keyDown[b]=!1;$(document).on("keyup",a.onKeyUp);$(document).on("keydown",a.onKeyDown);window.requestAnimationFrame(a.phaseInLoop)};this.phaseInLoop=function(){window.requestAnimationFrame(a.mainLoop)};this.mainLoop=function(){d.gameClock.tick();a.draw();a.baseY-=50*d.gameClock.convertTimeIntervalToSeconds(d.gameClock.deltaTime);a.keyPressed("ESC")&&(a.exitLeaderboard=!0);a.exitLeaderboard?window.requestAnimationFrame(a.initPhaseOut):
window.requestAnimationFrame(a.mainLoop)};this.initPhaseOut=function(){window.requestAnimationFrame(a.phaseOutLoop)};this.phaseOutLoop=function(){window.requestAnimationFrame(a.leaveStage)};this.leaveStage=function(){$(document).off("keydown");$(document).off("keyup");a.leaveState.id="mainMenu";a.leaveState.params={};var b=a.transitionLinks[a.leaveState.id];b.preTransition(a.leaveState.params);window.requestAnimationFrame(b.init);a.leaveState.id=null;a.leaveState.params=null};this.onKeyDown=function(b){a.keyDown[b.keyCode]=
!0};this.onKeyUp=function(b){a.keyDown[b.keyCode]=!1};this.keyPressed=function(a){return this.keyDown[d.Keys[a]]};this.draw=function(){a.backgroundImage&&(e.globalAlpha=.4,a.backgroundImage.draw());e.globalAlpha=1;e.fillStyle="#FFF";e.font="30pt Amatic SC";var b=a.baseY;var c=e.measureText("Leaderboard");e.fillText("Leaderboard",g.width/2-c.width/2,b);b+=50;c=e.measureText("-----------");e.fillText("-----------",g.width/2-c.width/2,b);b+=50;c=e.measureText("   ");e.fillText("   ",g.width/2-c.width/
2,b);for(var b=b+50,k=0;k<d.scores.length;++k){var r=d.scores[k].name+"     "+d.scores[k].score;c=e.measureText(r);e.fillText(r,g.width/2-c.width/2,b);b+=50}}};return c}(OverDrive.Stages.Leaderboard||{},OverDrive.canvas,OverDrive.context);OverDrive.Stages.Credits=function(c,g,e){var d=OverDrive.Game.system,a="The Wonky Donkey Crew;---------------------;Jade;Hayley;Nick;Owen;Paul;Joshua;Beth;Will;Megan;Hollie;Bethan;Anna; ;Erin;Lewis;Tegan;Krystal;Kye;Maisie;Alisha;Leon;Ben;Finley;Charlie;Joshua;Connor;Jenna;Mason;Tia;Joey;Lowrie;Kory;Bethan;Nicky;Jack;Chole;Madison;Amba;Delyth;Laila;Livvi".split(";");c.Create=function(){return new c.CreditsStage};c.CreditsStage=function(){var b=this;this.transitionLinks={mainMenu:null};this.setTransition=
function(a,c){b.transitionLinks[a]=c};this.leaveState={id:null,params:null};this.backgroundImage=null;this.baseY=600;this.exitCredits=!1;this.keyDown=null;this.preTransition=function(a){this.backgroundImage=a.backgroundImage};this.init=function(){b.baseY=600;b.exitCredits=!1;null===b.keyDown&&(b.keyDown=Array(256));for(var a=0;256>a;++a)b.keyDown[a]=!1;$(document).on("keyup",b.onKeyUp);$(document).on("keydown",b.onKeyDown);window.requestAnimationFrame(b.phaseInLoop)};this.phaseInLoop=function(){window.requestAnimationFrame(b.mainLoop)};
this.mainLoop=function(){d.gameClock.tick();b.draw();b.baseY-=50*d.gameClock.convertTimeIntervalToSeconds(d.gameClock.deltaTime);b.keyPressed("ESC")&&(b.exitCredits=!0);b.exitCredits?window.requestAnimationFrame(b.initPhaseOut):window.requestAnimationFrame(b.mainLoop)};this.initPhaseOut=function(){window.requestAnimationFrame(b.phaseOutLoop)};this.phaseOutLoop=function(){window.requestAnimationFrame(b.leaveStage)};this.leaveStage=function(){$(document).off("keydown");$(document).off("keyup");b.leaveState.id=
"mainMenu";b.leaveState.params={};var a=b.transitionLinks[b.leaveState.id];a.preTransition(b.leaveState.params);window.requestAnimationFrame(a.init);b.leaveState.id=null;b.leaveState.params=null};this.onKeyDown=function(a){b.keyDown[a.keyCode]=!0};this.onKeyUp=function(a){b.keyDown[a.keyCode]=!1};this.keyPressed=function(a){return this.keyDown[d.Keys[a]]};this.draw=function(){b.backgroundImage&&(e.globalAlpha=.4,b.backgroundImage.draw());e.globalAlpha=1;e.fillStyle="#FFF";e.font="30pt Amatic SC";
for(var c=b.baseY,d=0;d<a.length;++d){var r=e.measureText(a[d]);e.fillText(a[d],g.width/2-r.width/2,c);c+=50}}};return c}(OverDrive.Stages.Credits||{},OverDrive.canvas,OverDrive.context);
