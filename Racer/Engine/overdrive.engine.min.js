var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,e,b){c!=Array.prototype&&c!=Object.prototype&&(c[e]=b.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,e,b,a){if(e){b=$jscomp.global;c=c.split(".");for(a=0;a<c.length-1;a++){var d=c[a];d in b||(b[d]={});b=b[d]}c=c[c.length-1];a=b[c];e=e(a);e!=a&&null!=e&&$jscomp.defineProperty(b,c,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.fill",function(c){return c?c:function(c,b,a){var d=this.length||0;0>b&&(b=Math.max(0,d+b));if(null==a||a>d)a=d;a=Number(a);0>a&&(a=Math.max(0,d+a));for(b=Number(b||0);b<a;b++)this[b]=c;return this}},"es6-impl","es3");
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var e=0;return $jscomp.iteratorPrototype(function(){return e<c.length?{done:!1,value:c[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.iteratorFromArray=function(c,e){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var b=0,a={next:function(){if(b<c.length){var d=b++;return{value:e(d,c[d]),done:!1}}a.next=function(){return{done:!0,value:void 0}};return a.next()}};a[Symbol.iterator]=function(){return a};return a};
$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6-impl","es3");OverDrive.MetLib=function(c){c.fEqual=function(c,b,a){return Math.abs(c-b)<(void 0===a?1E-8:a)};return c}(OverDrive.MetLib||{});OverDrive.Game=function(c,e,b){c.Background=function(a){var d=this;this.onLoaded=function(){d.backgroundLoaded=!0};this.draw=function(){d.backgroundLoaded&&(b.clearRect(0,0,e.width,e.height),b.drawImage(d.image,0,0,e.width,e.height))};this.backgroundLoaded=!1;this.image=new Image;this.image.onload=this.onLoaded();this.image.src=a};return c}(OverDrive.Game||{},OverDrive.canvas,OverDrive.context);OverDrive.Game=function(c,e,b){c.FrameCounter=function(){this.averageSPF=this.maxSPF=this.minSPF=this.secondsPerFrame=this.averageFPS=this.maxFPS=this.minFPS=this.framesPerSecond=this.fpsCounts=this.fpsRefTimeIndex=this.frame=0;this.resetCounter=function(){this.averageSPF=this.maxSPF=this.minSPF=this.secondsPerFrame=this.averageFPS=this.maxFPS=this.minFPS=this.framesPerSecond=this.fpsCounts=this.fpsRefTimeIndex=this.frame=0};this.updateFrameCounterForElapsedTime=function(a){this.frame+=1;var b=a-
this.fpsRefTimeIndex;1<=b&&(this.framesPerSecond=this.frame/b,this.secondsPerFrame=1/this.framesPerSecond,0==this.fpsCounts?(this.averageFPS=this.maxFPS=this.minFPS=this.framesPerSecond,this.averageSPF=this.maxSPF=this.minSPF=this.secondsPerFrame):(this.framesPerSecond<this.minFPS?this.minFPS=this.framesPerSecond:this.framesPerSecond>this.maxFPS&&(this.maxFPS=this.framesPerSecond),this.averageFPS+=this.framesPerSecond,this.secondsPerFrame<this.minSPF?this.minSPF=this.secondsPerFrame:this.secondsPerFrame>
this.maxSPF&&(this.maxSPF=this.secondsPerFrame),this.averageSPF+=this.secondsPerFrame),this.frame=0,this.fpsRefTimeIndex=a,this.fpsCounts+=1)};this.getAverageFPS=function(){return this.averageFPS/this.fpsCounts};this.getAverageSPF=function(){return this.averageSPF/this.fpsCounts}};c.Clock=function(){this.performanceFrequency=1E3;this.timeRecip=1/this.performanceFrequency;this.actualTime=function(){return window.performance.now()};this.convertTimeIntervalToSeconds=function(a){return a*this.timeRecip};
this.prevTimeIndex=this.baseTime=this.actualTime();this.totalStopTime=this.stopTimeIndex=this.deltaTime=this.currentTimeIndex=0;this.clockStopped=!1;this.frameCounter=new c.FrameCounter;this.resetClockAttributes=function(){this.prevTimeIndex=this.baseTime=this.actualTime();this.totalStopTime=this.stopTimeIndex=this.deltaTime=0;this.clockStopped=!1;this.frameCounter=new FrameCounter};this.invalidateClock=function(){this.totalStopTime=this.stopTimeIndex=this.deltaTime=this.currentTimeIndex=this.prevTimeIndex=
this.baseTime=0;this.clockStopped=!0;this.frameCounter=null};this.start=function(){if(this.clockStopped){var a=this.actualTime();this.totalStopTime+=a-this.stopTimeIndex;this.prevTimeIndex=a;this.clockStopped=!1}};this.stop=function(){this.clockStopped||(this.stopTimeIndex=this.actualTime(),this.clockStopped=!0)};this.tick=function(){this.clockStopped?this.deltaTime=0:(this.currentTimeIndex=this.actualTime(),this.deltaTime=this.currentTimeIndex-this.prevTimeIndex,this.prevTimeIndex=this.currentTimeIndex,
this.frameCounter&&this.frameCounter.updateFrameCounterForElapsedTime(this.convertTimeIntervalToSeconds(this.currentTimeIndex-this.baseTime-this.totalStopTime)))};this.reset=function(){this.resetClockAttributes();frameCounter&&frameCounter.resetCounter()};this.actualTimeElapsed=function(){return this.convertTimeIntervalToSeconds(this.actualTime()-this.baseTime)};this.gameTimeElapsed=function(){var a=(this.clockStopped?this.stopTimeIndex:this.actualTime())-this.baseTime-this.totalStopTime;return this.convertTimeIntervalToSeconds(a)}};
return c}(OverDrive.Game||{},OverDrive.canvas,OverDrive.context);OverDrive.Game=function(c,e,b){c.CollisionModel={StaticScene:{Category:1,Mask:2},Player:{Category:2,Mask:63},Projectile:{Category:4,Mask:22},Pickup:{Category:8,Mask:6},NPC:{Category:16,Mask:6},PathNode:{Category:32,Mask:2}};return c}(OverDrive.Game||{},OverDrive.canvas,OverDrive.context);OverDrive.Game=function(c,e,b){c.Player=function(a){var d=Matter.World,c=Matter.Bodies,f=Matter.Body,e=this;this.strength=100;this.score=0;this.scale=a.scale;this.size=this.mBody=null;this.pid=a.pid;this.rechargeRate=1;this.forwardForce=a.forwardForce;this.rotateSpeed=a.rotateSpeed;this.sprite=new OverDrive.Game.Sprite(a.spriteURI,function(b,g){var h={width:b*e.scale*a.boundingVolumeScale,height:g*e.scale*a.boundingVolumeScale};e.mBody=c.rectangle(a.x,a.y,h.width,h.height);f.setAngle(e.mBody,a.angle);
e.size=h;f.setMass(e.mBody,a.mass);e.mBody.collisionFilter.group=a.collisionGroup;e.mBody.collisionFilter.category=OverDrive.Game.CollisionModel.Player.Category;e.mBody.collisionFilter.mask=OverDrive.Game.CollisionModel.Player.Mask;e.mBody.frictionAir=track_friction;e.mBody.hostObject=e;d.add(a.world,[e.mBody]);e.preUpdate=a.preUpdate;e.postUpdate=a.postUpdate});this.fireRechargeTime=0;this.draw=function(){if(this.mBody){b.save();var a=this.mBody.position,d=this.mBody.angle;b.translate(a.x,a.y);b.rotate(d);
b.translate(-this.sprite.image.width*this.scale/2,-this.sprite.image.height*this.scale/2);this.sprite.draw(0,0,this.scale);b.restore()}};this.drawBoundingVolume=function(a){if(this.mBody){var d=this.forwardDirection(),f=-d.y,c=d.x,g=this.mBody.position,h=this.sprite.image.width*this.scale/2,e=this.sprite.image.height*this.scale/2;b.lineWidth=2;b.strokeStyle="#FF0000";b.beginPath();b.moveTo(g.x,g.y);b.lineTo(g.x+f*h,g.y+c*h);b.stroke();b.strokeStyle="#00FF00";b.beginPath();b.moveTo(g.x,g.y);b.lineTo(g.x+
d.x*e,g.y+d.y*e);b.stroke();b.beginPath();d=this.mBody.vertices;b.moveTo(d[0].x,d[0].y);for(f=1;f<d.length;++f)b.lineTo(d[f].x,d[f].y);b.lineTo(d[0].x,d[0].y);b.lineWidth=1;b.strokeStyle=a;b.stroke()}};this.forwardDirection=function(){if(this.mBody){var a=this.mBody.angle;return{x:-Math.sin(-a),y:-Math.cos(-a)}}};this.applyForce=function(a,d){f.applyForce(this.mBody,a,d)};this.applyTorque=function(a,d){var b=this.forwardDirection(),f=-b.y,b=b.x;player1.applyForce(a,{x:f*d,y:b*d});player1.applyForce(player1.mBody.position,
{x:f*-d,y:b*-d})};this.rotate=function(a){f.rotate(this.mBody,a)};this.addStrength=function(a){this.strength=Math.max(0,Math.min(100,this.strength+a))};this.addPoints=function(a){this.score=Math.max(0,this.score+a)};this.updateStrength=function(a){this.strength+=a};this.increaseFireRate=function(a){this.rechargeRate*=a};this.doCollision=function(a,d){a.collideWithPlayer(this,{objA:d.objB,objB:d.objA,host:d.host})};this.collideWithPlayer=function(a,d){console.log("Oi, knock it off!")};this.collideWithProjectile=
function(a,d){};this.collideWithPickup=function(a,d){a.collideWithPlayer(this,{objA:d.objB,objB:d.objA,host:d.host})};this.collideWithNPC=function(a,d){console.log("Ouch from player!")};this.collideWithPath=function(a,d){a.collideWithPlayer(this,{objA:d.objB,objB:d.objA,host:d.host})}};return c}(OverDrive.Game||{},OverDrive.canvas,OverDrive.context);OverDrive.Region=function(c,e,b){c.Create=function(){return{points:[],graph:[],collisionModel:{vertices:null,isConvex:!1}}};c.BuildCollisionModel=function(a){a.collisionModel.vertices=Matter.Vertices.create(a.points,Matter.Body.create({}));Matter.Vertices.clockwiseSort(a.collisionModel.vertices);a.collisionModel.isConvex=Matter.Vertices.isConvex(a.collisionModel.vertices)};c.Render=function(a,d,c){c=void 0===c?"#00F":c;b.beginPath();b.moveTo(a.points[0].x*e.width,a.points[0].y*e.height);for(var f=
1;f<a.points.length;++f)b.lineTo(a.points[f].x*e.width,a.points[f].y*e.height);b.closePath();b.globalAlpha=.2;b.fillStyle=c;b.fill();b.globalAlpha=1;a.collisionModel.isConvex?(b.strokeStyle="#FFF",b.fillStyle="#FFF"):(b.strokeStyle="#F00",b.fillStyle="#F00");b.beginPath();b.moveTo(a.points[0].x*e.width,a.points[0].y*e.height);for(f=1;f<a.points.length;++f)b.lineTo(a.points[f].x*e.width,a.points[f].y*e.height);1==d&&b.closePath();b.lineWidth=1;b.stroke();for(f=0;f<a.points.length;++f)b.beginPath(),
b.arc(a.points[f].x*e.width,a.points[f].y*e.height,5,0,2*Math.PI),b.fill()};return c}(OverDrive.Region||{},OverDrive.canvas,OverDrive.context);OverDrive.Graph=function(c,e,b){c.EdgeMatch=function(a,d){var b=OverDrive.MetLib.fEqual;return b(a.p1.x,d.p1.x)&&b(a.p1.y,d.p1.y)&&b(a.p2.x,d.p2.x)&&b(a.p2.y,d.p2.y)};c.ClearGraph=function(a){for(var d=0;d<a.length;++d)a[d].graph=[]};c.BuildGraph=function(a){c.ClearGraph(a);for(var d=0;d<a.length-1;++d)for(var b=a[d].collisionModel.vertices.length,f=d+1;f<a.length;++f)for(var e=a[f].collisionModel.vertices.length,h=!1,m=0;m<b&&!h;++m)for(var n={p1:a[d].collisionModel.vertices[m],p2:a[d].collisionModel.vertices[m<
b-1?m+1:0]},k=0;k<e&&!h;++k)c.EdgeMatch(n,{p1:a[f].collisionModel.vertices[k<e-1?k+1:0],p2:a[f].collisionModel.vertices[k]})&&(a[d].graph.push({region:a[f],index:f}),h=!0)};c.AugmentGraph=function(a,d){for(var b=d.collisionModel.vertices.length,f=0;f<a.length;++f)for(var e=!1,h=a[f].collisionModel.vertices.length,m=0;m<h&&!e;++m)for(var n={p1:a[f].collisionModel.vertices[m],p2:a[f].collisionModel.vertices[m<h-1?m+1:0]},k=0;k<b&&!e;++k)c.EdgeMatch(n,{p1:d.collisionModel.vertices[k<b-1?k+1:0],p2:d.collisionModel.vertices[k]})&&
(a[f].graph.push({region:a[j],index:j}),e=!0)};c.Render=function(a){var d=function(a,d){var f=Matter.Vertices.centre(a.collisionModel.vertices),c=Matter.Vertices.centre(d.collisionModel.vertices),g=f.x*e.width,f=f.y*e.height,h=c.x*e.width-g,l=c.y*e.height-f,c=Math.atan2(l,h),h=Math.sqrt(h*h+l*l),p=l=void 0,l=void 0===l?1:l,p=void 0===p?"#FF0":p;b.save();b.translate(g,f);b.rotate(c);b.beginPath();b.moveTo(0,0);b.lineTo(h,0);b.strokeStyle=p;b.lineWidth=l;b.stroke();b.beginPath();b.moveTo(h,0);b.lineTo(h-
10,-3);b.lineTo(h-10,3);b.closePath();b.fillStyle=p;b.fill();b.restore()};0<a.length&&0<a[0].graph.length&&(d(a[0],a[0].graph[0].region),1<a[0].graph.length&&d(a[0].graph[1].region,a[0]));for(var c=1;c<a.length-1;++c)if(0<a[c].graph.length)for(var f=0;f<a[c].graph.length;++f)d(a[c],a[c].graph[f].region)};return c}(OverDrive.Graph||{},OverDrive.canvas,OverDrive.context);OverDrive.Game=function(c,e,b){c.Path=function(a,d,b){b=void 0===b?1:b;var f=this;this.regions=a;for(var c=0;c<a.length;++c){for(var g=[],m=0,n=0,k=0;k<a[c].collisionModel.vertices.length;++k)m+=a[c].collisionModel.vertices[k].x*e.width,n+=a[c].collisionModel.vertices[k].y*e.height;m/=a[c].collisionModel.vertices.length;n/=a[c].collisionModel.vertices.length;for(k=0;k<a[c].collisionModel.vertices.length;++k)g.push({x:a[c].collisionModel.vertices[k].x*e.width,y:a[c].collisionModel.vertices[k].y*e.height});
g=Matter.Bodies.fromVertices(m,n,g,{isSensor:!0});g.hostObject=f;g.pathIndex=c;g.collisionFilter.group=0;g.collisionFilter.category=OverDrive.Game.CollisionModel.PathNode.Category;g.collisionFilter.mask=OverDrive.Game.CollisionModel.PathNode.Mask;Matter.World.add(d,g)}this.isClosed=2==a[0].graph.length&&1==a[0].graph[0].index&&a[0].graph[1].index==a.length-1;this.maxIterations=b;this.initPathPlacement=function(){return{hostPath:f,currentIteration:0,pathComplete:!1,currentRegionIndex:-1,nextExpectedRegions:[0],
largestRegionIndex:-1}};this.doCollision=function(a,d){a.collideWithPath(this,{objA:d.objB,objB:d.objA,host:d.host})};this.collideWithPlayer=function(a,d){var b=a.pathLocation,c=d.objA.pathIndex,g=b.nextExpectedRegions.indexOf(c);if(-1!=g||c<b.currentRegionIndex||c==b.largestRegionIndex)if(-1!=g&&f.isClosed&&b.currentRegionIndex==f.regions.length-1&&(b.currentIteration++,console.log("Lap = "+b.currentIteration),b.largestRegionIndex=-1,b.currentIteration==f.maxIterations&&(b.pathComplete=!0,console.log("Closed path complete!!!"))),
b.currentRegionIndex=c,console.log("proceed to : "+b.currentRegionIndex),c>b.largestRegionIndex&&(b.largestRegionIndex=c),0==b.currentRegionIndex)if(f.isClosed)b.nextExpectedRegions=[1];else for(b.nextExpectedRegions=[],c=0;c<f.regions[b.currentRegionIndex].graph.length;++c)b.nextExpectedRegions.push(f.regions[b.currentRegionIndex].graph[c].index);else if(b.currentRegionIndex==f.regions.length-1)f.isClosed?b.nextExpectedRegions=[0]:(b.pathComplete=!0,console.log("Open path complete!!!"));else for(b.nextExpectedRegions=
[],c=0;c<f.regions[b.currentRegionIndex].graph.length;++c)b.nextExpectedRegions.push(f.regions[b.currentRegionIndex].graph[c].index)}};return c}(OverDrive.Game||{},OverDrive.canvas,OverDrive.context);OverDrive.Game=function(c,e,b){c.Sprite=function(a,d){var c=this;this.onLoaded=function(){c.spriteLoaded=!0;void 0!==d&&d(c.image.width,c.image.height)};this.draw=function(a,d,e){c.spriteLoaded&&b.drawImage(c.image,a,d,c.image.width*e,c.image.height*e)};this.spriteLoaded=!1;this.image=new Image;this.image.onload=this.onLoaded;this.image.src=a};return c}(OverDrive.Game||{},OverDrive.canvas,OverDrive.context);OverDrive.Game=function(c,e,b){c.SpriteSheet=function(a,b,c){var d=this;this.onLoaded=function(){d.spriteLoaded=!0;void 0!==c&&c(d.image.width,d.image.height)};this.draw=function(a,b,c,f,e){d.spriteLoaded&&0<=e&&e<d.rows*d.cols&&a.drawImage(d.image,e%d.cols*d.spriteWidth,(e-e%d.cols)/d.cols*d.spriteHeight,d.spriteWidth,d.spriteHeight,b,c,d.spriteWidth*f,d.spriteHeight*f)};this.rows=b.numberOfRows;this.cols=b.numberOfColums;this.spriteWidth=b.spriteWidth;this.spriteHeight=b.spriteHeight;this.framesPerSecond=
b.framesPerSecond;this.invFPS=1/this.framesPerSecond;this.spriteLoaded=!1;this.image=new Image;this.image.onload=this.onLoaded;this.image.src=a};return c}(OverDrive.Game||{},OverDrive.canvas,OverDrive.context);var music1=null,music2=null,music3=null;function loadDemoSoundAsync(c,e){console.log("loading "+c);var b=new XMLHttpRequest;b.open("GET",c,!0);b.responseType="arraybuffer";b.onload=function(){OverDrive.Game.system.audioContext.decodeAudioData(b.response,e,function(a){console.log("Error with decoding audio data"+a.err)})};b.send()}
OverDrive.Game=function(c,e,b){c.InputMode={Keyboard:0,Gamepad:1};c.AudioResource=function(a){this.buffer=a;this.play=function(a,b){var d=OverDrive.Game.system.audioContext.createBufferSource();d.buffer=this.buffer;d.connect(OverDrive.Game.system.gainNode);d.onended=b;d.start(a)}};c.System=function(){var a=this;this.canvas=e;this.context=b;this.gameClock=new OverDrive.Game.Clock;this.engine=Matter.Engine.create();this.Keys={RETURN:13,ESC:27,SPACE:32,PGUP:33,PGDOWN:34,END:35,HOME:36,LEFT:37,UP:38,
RIGHT:39,DOWN:40,DEL:46,K_0:48,K_1:49,K_2:50,K_3:51,K_4:52,K_5:53,K_6:54,K_7:55,K_8:56,K_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90};this.settings={players:[{name:"Player 1",mode:c.InputMode.Keyboard,keys:{forward:"Q",reverse:"A",left:"Z",right:"X"}},{name:"Player 2",mode:c.InputMode.Gamepad,keys:{forward:"P",reverse:"L",left:"N",right:"M"}}],sfxVolume:50,musicVolume:50};this.stageGraph=null;this.scores=[{name:"Bilbo",
score:150},{name:"Woody",score:120},{name:"Buzz",score:100},{name:"BB-8",score:80},{name:"Mr Ploppy",score:60},{name:"Darth Vader",score:50}];this.sortScores=function(){this.scores.sort(function(a,b){return b.score-a.score})};this.Gamepad={gamepads:{},observers:[],bindings:[{gamepadIndex:-1},{gamepadIndex:-1}],connected:function(b){b=b.originalEvent.gamepad;a.Gamepad.gamepads[b.index]=b;console.log("gamepad %d CONNECTED ",b.index);console.log("id = "+b.id);console.log("mapping = "+b.mapping);console.log("connected = "+
b.connected);console.log("buttons = "+b.buttons);console.log("axes = "+b.axes);console.log("timestamp = "+b.timestamp)},disconnected:function(b){b=b.originalEvent.gamepad;delete a.Gamepad.gamepads[b.index];a.Gamepad.removeGamepadBinding(b);console.log("gamepad %d removed ",b.index)},createGamepadBinding:function(b,c){a.Gamepad.binding[b].gamepadIndex=c.index},removeGamepadBinding:function(b){a.Gamepad.bindings[0].gamepadIndex==b.index?a.Gamepad.bindings[0].gamepadIndex=-1:a.Gamepad.bindings[1].gamepadIndex==
b.index&&(a.Gamepad.bindings[1].gamepadIndex=-1)},clearBindings:function(){this.bindings[0].gamepadIndex=-1;this.bindings[1].gamepadIndex=-1},isGamepadBound:function(b){return b==a.Gamepad.bindings[0].gamepadIndex||b==a.Gamepad.bindings[1].gamepadIndex},getConnectedGamepadIndices:function(){return Object.keys(a.Gamepad.gamepads)},getConnectedGamepadArray:function(){for(var a=[],b=this.getConnectedGamepadIndices(),c=0;c<b.length;++c)a.push(this.gamepads[b[c]]);return a},getUnboundGamepadArray:function(){for(var a=
[],b=this.getConnectedGamepadIndices(),c=0;c<b.length;++c)this.isGamepadBound(b[c])||a.push(this.gamepads[b[c]]);return a},gamepadButtonPressed:function(a){for(var b=!1,c=0;c<a.buttons.length&&!b;++c)b=a.buttons[c].pressed;return b},registerObserver:function(b,c,f,e){a.Gamepad.observers.push({observer:b,eventType:c,handler:f,tag:void 0===e?"generic":e})},unregisterObserver:function(b,c,f){c=void 0===c?"all":c;f=void 0===f?"all":f;for(var d=a.Gamepad.observers,e=0;e<d.length;)d[e].observer!==b||"all"!=
c&&c!=d[e].eventType||"all"!=f&&f!=d[e].tag?++e:d.splice(e,1)},unregisterAllObservers:function(){a.Gamepad.observers=[]}};$(window).on("gamepadconnected",this.Gamepad.connected);$(window).on("gamepaddisconnected",this.Gamepad.disconnected);this.playMusic1=function(){music1.play(0,a.playMusic2)};this.playMusic2=function(){music2.play(0,a.playMusic3)};this.playMusic3=function(){music3.play(0,a.playMusic1)};this.audioContext=new (window.AudioContext||window.webkitAudioContext),this.gainNode=this.audioContext.createGain(),
this.gainNode.connect(this.audioContext.destination),loadDemoSoundAsync("Assets/Sounds/Kyes_music.m4a",function(b){music1=new c.AudioResource(b);a.playMusic1()}),loadDemoSoundAsync("Assets/Sounds/Mason_and_jack.m4a",function(a){music2=new c.AudioResource(a)}),loadDemoSoundAsync("Assets/Sounds/Kory_music.m4a",function(a){music3=new c.AudioResource(a)})};c.system=null;return c}(OverDrive.Game||{},OverDrive.canvas,OverDrive.context);OverDrive.Game=function(c,e,b){c.drawObjects=function(a){for(i=0;i<a.length;++i)a[i]&&a[i].draw()};c.enterFullscreen=function(a){a.requestFullscreen?document.fullScreenElement?(document.cancelFullScreen(),console.log("cancelFullScreen")):(a.requestFullscreen(),console.log("requestFullscreen")):a.msRequestFullscreen?document.msFullscreenElement?(document.msExitFullscreen(),console.log("msExitFullscreen")):(a.msRequestFullscreen(),console.log("msRequestFullscreen")):a.mozRequestFullScreen?document.mozFullScreenElement?
(document.mozCancelFullScreen(),console.log("mozCancelFullScreen")):(a.mozRequestFullScreen(),console.log("mozRequestFullScreen")):a.webkitRequestFullscreen&&(document.webkitFullscreenElement?(document.webkitCancelFullScreen(),console.log("webkitCancelFullScreen")):(a.webkitRequestFullscreen(),console.log("webkitRequestFullscreen")))};c.drawHUD=function(a,c,g,f,l){b.fillStyle="#FFF";b.font="30pt Amatic SC";var d=b.measureText(a.pid);b.fillText(a.pid,.2*e.width-d.width/2,50);d=b.measureText(c.pid);
b.fillText(c.pid,.8*e.width-d.width/2,50);b.font="24px Amatic SC";d=b.measureText("Points: "+a.score);b.fillText("Points: "+a.score,.2*e.width-d.width/2,110);d=b.measureText("Points: "+c.score);b.fillText("Points: "+c.score,.8*e.width-d.width/2,110);a=Math.min(a.pathLocation.currentIteration+1,l);c=Math.min(c.pathLocation.currentIteration+1,l);d=b.measureText("Lap: "+a);b.fillText("Lap: "+a,.2*e.width-d.width/2,80);d=b.measureText("Lap: "+c);b.fillText("Lap: "+c,.8*e.width-d.width/2,80);g?(d=Math.floor(f%
60),f=Math.floor(f/60),f=(10>f?"0":"")+f+" : "+(10>d?"0":"")+d):f="00 : 00";b.font="30pt Amatic SC";d=b.measureText(f);b.fillText(f,.5*e.width-d.width/2,50)};return c}(OverDrive.Game||{},OverDrive.canvas,OverDrive.context);OverDrive.Pickup=function(c,e,b){c.PickupType=function(a){this.handler=a.handler;this.collisionGroup=a.collisionGroup;this.sprite=new OverDrive.Game.Sprite(a.spriteURI)};c.Pickup=function(a){var c=this;this.type=a.type;this.scale=pickup_sprite_scale;this.mBody=Matter.Bodies.rectangle(a.pos.x,a.pos.y,this.type.sprite.image.width*this.scale*a.boundingVolumeScale,this.type.sprite.image.height*this.scale*a.boundingVolumeScale,{isStatic:a.isStatic,isSensor:!0,collisionFilter:{group:a.type.collisionGroup,
category:OverDrive.Game.CollisionModel.Pickup.Category,mask:OverDrive.Game.CollisionModel.Pickup.Mask}});Matter.Body.setMass(this.mBody,0);this.mBody.hostObject=this;this.draw=function(){if(c.mBody){b.save();var a=c.mBody.position;b.translate(a.x,a.y);b.translate(-c.type.sprite.image.width*c.scale/2,-c.type.sprite.image.height*c.scale/2);c.type.sprite.draw(0,0,c.scale);b.restore()}};this.drawBoundingVolume=function(){b.beginPath();var a=c.mBody.vertices;b.moveTo(a[0].x,a[0].y);for(var d=1;d<a.length;++d)b.lineTo(a[d].x,
a[d].y);b.lineTo(a[0].x,a[0].y);b.lineWidth=1;b.strokeStyle="#FFFFFF";b.stroke()};this.doCollision=function(a,b){a.collideWithPickup(this,{objA:b.objB,objB:b.objA,host:b.host})};this.collideWithPlayer=function(a,b){c.type.handler(a);Matter.World.remove(OverDrive.Game.system.engine.world,c.mBody);b.host.pickupArray.splice(b.host.pickupArray.indexOf(c),1)};this.collideWithProjectile=function(a,b){};this.collideWithPickup=function(a,b){}};c.processPickups=function(a,b,g,f,l){var d=null;g-=f;0>=g&&(g=
Matter.Vertices.centre(l[Math.floor(Math.random()*(l.length-1))].collisionModel.vertices),g.x*=e.width,g.y*=e.height,f=Object.keys(a),l=f.length,d=new c.Pickup({pos:g,type:a[f[Math.round(Math.random()*l)%l]],world:b.world,boundingVolumeScale:.75,isStatic:!0}),g=pickup_time_delay);return{timer:g,newPickup:d}};return c}(OverDrive.Pickup||{},OverDrive.canvas,OverDrive.context);
